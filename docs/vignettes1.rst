Example Data & Notebooks
========================

Last updated: 2024-07-16

This vignette provides an overview of the example data and accompanying notebooks available for the SDePER package. The example data includes pairs of spatial data (both simulated and real spatial transcriptomic (ST) datasets) with corresponding reference scRNA-seq data. The notebooks detail the description of the notebook, input data (with links to download the data), SDePER settings, running logs, and links to the corresponding results.


Simulated ST data
-----------------

We generated **5 sets of simulated ST datasets**, resulting in **14 combinations of simulated ST and various reference data**. For each combination, we provide a link to the corresponding SDePER notebook, which includes links to documentation on the generation of simulated ST data and reference data preprocessing procedures, and links to download the corresponding ST and reference data.

+-----------------------------+------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Simulated ST data           | Reference scRNA-seq data                             | Notebook                                                                                                                                                                                     |
+=============================+======================================================+==============================================================================================================================================================================================+
| STARmap-based simulation    | Internal reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation/Run_SDePER_on_simulation_data/Scenario_1/ref_spatial/S1_ref_spatial_SDePER_WITH_CVAE.ipynb>`__                           |
+                             +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation/Run_SDePER_on_simulation_data/Scenario_1/ref_scRNA_seq/S1_ref_scRNA_SDePER_WITH_CVAE.ipynb>`__                           |
+                             +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference with *Vip* missing                | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation/Run_SDePER_on_simulation_data/Scenario_2/S2_ref_scRNA_SDePER_WITH_CVAE.ipynb>`__                                         |
+                             +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference adding irrelevant *high intronic* | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation/Run_SDePER_on_simulation_data/Scenario_3/S3_ref_scRNA_SDePER_WITH_CVAE.ipynb>`__                                         |
+                             +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | Internal reference with downsampled *Oligo*          | `GO <https://github.com/az7jh2/SDePER_Analysis/tree/main/Simulation/Run_SDePER_on_simulation_data_with_downsampled_ref/Oligo/Scenario_1/ref_spatial>`__                                      |
+                             +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference with downsampled *Oligo*          | `GO <https://github.com/az7jh2/SDePER_Analysis/tree/main/Simulation/Run_SDePER_on_simulation_data_with_downsampled_ref/Oligo/Scenario_1/ref_scRNA_seq>`__                                    |
+-----------------------------+------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| STARmap-based simulation    | Internal reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation/Run_SDePER_on_simulation_data_subsetCT/Scenario_1/ref_spatial/S1_ref_spatial_SDePER_WITH_CVAE.ipynb>`__                  |
+ with 5 cell types           +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation/Run_SDePER_on_simulation_data_subsetCT/Scenario_1/ref_scRNA_seq/S1_ref_scRNA_SDePER_WITH_CVAE.ipynb>`__                  |
+-----------------------------+------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Sequencing-based simulation | Internal reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation_seq_based/Run_SDePER_on_simulation_data/Scenario_1/ref_spatial/S1_ref_spatial_SDePER_WITH_CVAE.ipynb>`__                 |
+                             +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation_seq_based/Run_SDePER_on_simulation_data/Scenario_1/ref_scRNA_seq/S1_ref_scRNA_SDePER_WITH_CVAE.ipynb>`__                 |
+-----------------------------+------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Sequencing-based simulation | Internal reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation_seq_based/Run_SDePER_on_high_density_simulation_data/Scenario_1/ref_spatial/3x_S1_ref_spatial_SDePER_WITH_CVAE.ipynb>`__ |
+ with 3x higher cell density +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation_seq_based/Run_SDePER_on_high_density_simulation_data/Scenario_1/ref_scRNA_seq/3x_S1_ref_scRNA_SDePER_WITH_CVAE.ipynb>`__ |
+-----------------------------+------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Sequencing-based simulation | Internal reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation_seq_based/Run_SDePER_on_high_density_simulation_data/Scenario_1/ref_spatial/6x_S1_ref_spatial_SDePER_WITH_CVAE.ipynb>`__ |
+ with 6x higher cell density +------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                             | External reference                                   | `GO <https://github.com/az7jh2/SDePER_Analysis/blob/main/Simulation_seq_based/Run_SDePER_on_high_density_simulation_data/Scenario_1/ref_scRNA_seq/6x_S1_ref_scRNA_SDePER_WITH_CVAE.ipynb>`__ |
+-----------------------------+------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


Real ST data
------------

We collected **4 real ST datasets and their corresponding reference scRNA-seq datasets** for cell type deconvolution. Details of these datasets, preprocessing procedures and SDePER notebooks are summarised as below: 

+-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                           | Mouse Olfactory Bulb (**MOB**)                                                                                                                             | **Melanoma**                                                                                                                                                              | Breast Cancer                                                                                                                                                                            | IPF Lung                                                                                                                                                   |
+===========================================+============================================================================================================================================================+===========================================================================================================================================================================+==========================================================================================================================================================================================+============================================================================================================================================================+
| Spatial transcriptomics data source paper | `Visualization and analysis of gene expression in tissue sections by spatial transcriptomics. 2016,                                                        | `Spatially Resolved Transcriptomics Enables Dissection of Genetic Heterogeneity in Stage III Cutaneous Malignant Melanoma.                                                | `Spatial deconvolution of HER2-positive breast cancer delineates tumor-associated cell type interactions. 2021, Nature Communications <https://doi.org/10.1038/s41467-021-26271-2>`_     | `Our Paper <https://doi.org/10.1186/s13059-024-03416-2>`_                                                                                                  |
|                                           | Science <https://www.science.org/doi/10.1126/science.aaf2403>`_                                                                                            | 2018, Cancer Research <https://doi.org/10.1158/0008-5472.CAN-18-0747>`_                                                                                                   |                                                                                                                                                                                          |                                                                                                                                                            |
+-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Spatial transcriptomic technology         | Spatial Transcriptomics v1.0                                                                                                                               | Spatial Transcriptomics v1.0                                                                                                                                              | Spatial Transcriptomics v1.0                                                                                                                                                             | 10x Genomics Visium                                                                                                                                        |
+-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Reference scRNA-seq data source paper     | `Single-Cell RNA-Seq of Mouse Olfactory Bulb Reveals Cellular Heterogeneity and Activity-Dependent Molecular Census of Adult-Born Neurons. 2018,           | `A Cancer Cell Program Promotes T Cell Exclusion and Resistance to Checkpoint Blockade. 2018, Cell <https://doi.org/10.1016/j.cell.2018.09.006>`_                         | `A single-cell and spatially resolved atlas of human breast cancers. 2021, Nature Genetics <https://doi.org/10.1038/s41588-021-00911-1>`_                                                | `Single-cell RNA-seq reveals ectopic and aberrant lung-resident cell populations in idiopathic pulmonary fibrosis.                                         |
|                                           | Cell Reports <https://doi.org/10.1016/j.celrep.2018.11.034>`_                                                                                              |                                                                                                                                                                           |                                                                                                                                                                                          | 2020, Science Advances <https://doi.org/10.1126/sciadv.aba1983>`_                                                                                          |
+-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Reference scRNA-seq technology            | 10x Genomics Chromium Single Cell Gene Expression (droplet-based)                                                                                          | Smart-Seq2 (plate-based)                                                                                                                                                  | 10x Genomics Chromium Single Cell Gene Expression (droplet-based)                                                                                                                        | 10x Genomics Chromium Single Cell Gene Expression (droplet-based)                                                                                          |
+-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Preprocess for cell type deconvolution    | `MOB_preprocess.nb.html <https://rawcdn.githack.com/az7jh2/SDePER_Analysis/0a429908645a665c1f9d345df013d5b9fcde20b3/RealData/MOB/MOB_preprocess.nb.html>`_ | `Melanoma_preprocess.nb.html <https://rawcdn.githack.com/az7jh2/SDePER_Analysis/0a429908645a665c1f9d345df013d5b9fcde20b3/RealData/Melanoma/Melanoma_preprocess.nb.html>`_ | `Breast_Cancer_preprocess.nb.html <https://rawcdn.githack.com/az7jh2/SDePER_Analysis/0a429908645a665c1f9d345df013d5b9fcde20b3/RealData/Breast_Cancer/Breast_Cancer_preprocess.nb.html>`_ | `IPF_preprocess.nb.html <https://rawcdn.githack.com/az7jh2/SDePER_Analysis/c9b4698ecd9d0b1b0d2794df963127efe01ec231/RealData/IPF/IPF_preprocess.nb.html>`_ |
+-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+
| run SDePER on this real dataset           | `run_SDePER_on_MOB_data.ipynb <https://github.com/az7jh2/SDePER_Analysis/blob/main/RealData/MOB/run_SDePER_on_MOB_data.ipynb>`_                            | `run_SDePER_on_Melanoma_data.ipynb <https://github.com/az7jh2/SDePER_Analysis/blob/main/RealData/Melanoma/run_SDePER_on_Melanoma_data.ipynb>`_                            | `run_SDePER_on_Breast_Cancer_data.ipynb <https://github.com/az7jh2/SDePER_Analysis/blob/main/RealData/Breast_Cancer/run_SDePER_on_Breast_Cancer_data.ipynb>`_                            | `run_SDePER_on_IPF_data.ipynb <https://github.com/az7jh2/SDePER_Analysis/blob/main/RealData/IPF/run_SDePER_on_IPF_data.ipynb>`_                            |
+-------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+

Similarly, the links to download the ST and reference data are available in the notebooks.